<ng-container *ngIf="!showApplication">
    <div *ngIf="showModal" class="modal-backdrop">
    </div>

    <div *ngIf="showModal" class="modal">
        <div class="padding-hold">
            <p (click)="modalCloseClick()" id="close">Close</p>
            <h2>Management for the trip of {{ currentModalTrip.date | date:'MMM d, y' }}</h2>
            <div class="pure-g change-container">
                <div class="pure-u"><button (click)="updateTrip()" class="pure-button">Change Trip Leader</button></div>
                <div class="pure-u"><input [(ngModel)]="changeLeaderInput" type="text"></div>
            </div>
            <div class="pure-g change-container">
                <div class="pure-u"><button (click)="updateTrip()" class="pure-button">Change Trip Date</button></div>
                <div class="pure-u"><input [(ngModel)]="changeDateInput" type="text"></div>
            </div>
            <button (click)="changeStatus()" class="pure-button">Mark as {{getOppositeStatus()}}</button>
            <button (click)="deleteTrip()" class="pure-button">Delete</button>
        </div>
    </div>

    <div class="pure-g">
        <div class="pure-u-2-3">
            <h2>
                Modify Trips
            </h2>

            <table class="pure-table">
                <thead>
                <tr>
                    <th>Trip</th>
                    <th>Leader</th>
                    <th>Status</th>
                    <th>Action</th>
                </tr>
                </thead>

                <tbody *ngFor="let currentTripDate of tripDates; let i = index">
                <tr [ngClass]="{'pure-table-odd': i % 2 === 0}">
                    <td>{{currentTripDate.date}}</td>
                    <td>{{currentTripDate.tripLeader}}</td>
                    <td>{{currentTripDate.status}}</td>
                    <td class="manage" (click)="modalOpenClick(currentTripDate.id)">Manage</td>
                </tr>

                </tbody>
            </table>

        </div>
        <div class="pure-u-1-3">
            <div class="padding-hold">
                <h2>Add a Trip</h2>

                <form (ngSubmit)="onSubmit(tripDateForm)" class="pure-form pure-form-stacked" #tripDateForm="ngForm">
                    <fieldset>

                        <div class="input-container">
                            <my-date-picker ngModel name="tripDateField" [options]="myDatePickerOptions"
                                            #tripDateField="ngModel" placeholder="Trip Date" required></my-date-picker>
                        </div>

                        <div class="input-container">
                            <input ngModel name="leaderField" class="pure-input-1" placeholder="Leader" #leaderField="ngModel"
                                   required>
                            <span *ngIf="!leaderField.valid && formSubmittedAndNotProcessed" class="pure-form-message">This is a required field.</span>
                        </div>

                    </fieldset>

                    <button class="pure-button">Submit</button>
                </form>
            </div>
        </div>
    </div>

    <h2>Applications</h2>

    <ng-container *ngFor="let currentTripDate of tripDates">
        <h3>{{ currentTripDate.date | date:'MMM d, y' }}</h3>
        <table class="pure-table">
            <thead>
            <tr>
                <th>Name</th>
                <th>Submitted</th>
                <th>View</th>
            </tr>
            </thead>

            <tbody *ngFor="let currentApplication of applications; let i = index">
            <tr *ngIf="currentApplication.tripId === currentTripDate.id" [ngClass]="{'pure-table-odd': i % 2 === 0}">
                <td>{{currentApplication.first}} {{currentApplication.middle}} {{currentApplication.last}}</td>
                <td>{{ currentApplication.submitted | date:'MMM d, y' }}</td>
                <td class="manage" (click)="applicationOpenClick(currentApplication.id)">Manage</td>
            </tr>

            </tbody>
        </table>
    </ng-container>
</ng-container>

<ng-container *ngIf="showApplication">
    <h2 (click)="showApplication = false" id="back">Back to all applications</h2>
    <app-single-application [currentApplication]="currentApplication"></app-single-application>
</ng-container>
