<?php

// Reference: https://firebase.google.com/docs/auth/admin/verify-id-tokens

require_once "vendor/autoload.php";

use \Firebase\JWT\JWT;

try {
    $jwt = "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImtpZCI6Ik1FRTJORFpFTXpRNE5FWkRNamN5TnpNek1EZzRNVFV6TlRnMU9EQXpNekE0T1VKQlJqVTFPQSJ9.eyJuYW1lIjoiYWxleGtvcGVuQGdtYWlsLmNvbSIsIm5pY2tuYW1lIjoiYWxleGtvcGVuIiwicGljdHVyZSI6Imh0dHBzOi8vcy5ncmF2YXRhci5jb20vYXZhdGFyL2YxZDM2NDg1OTRhNjdiMmIzZTdlY2M4NTEzODY1YWViP3M9NDgwJnI9cGcmZD1odHRwcyUzQSUyRiUyRmNkbi5hdXRoMC5jb20lMkZhdmF0YXJzJTJGYWwucG5nIiwidXBkYXRlZF9hdCI6IjIwMTctMDgtMDdUMDM6NDk6MjguMjg4WiIsImVtYWlsIjoiYWxleGtvcGVuQGdtYWlsLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJpc3MiOiJodHRwczovL3ZvbHphcC5hdXRoMC5jb20vIiwic3ViIjoiYXV0aDB8NTk4N2IxY2Y5OTA0YmIzMGQwMTQ4MjQ0IiwiYXVkIjoidHZ3Um1GSjc1MWVPNjNmZFZUcms2ek1kQmZJb1UwdjciLCJleHAiOjE1MDIwNzc4MjgsImlhdCI6MTUwMjA3Nzc2OH0.7mK7FO8BPOxfNUolv7S9XIQRCGWHs9Ud7VPbtTVr-L_eieaHi64CGbqIUYOwfwZO44QvOpRZP0SudFM5P9S5_gN0hTfQSbqerGZySZni-_tdOqzmTJeFdM8NRVWxga8DQ_hGQO_k8nSwU6Xim7jSt2I6OmT1u4ehZb0VWvOOR6z9vDiRG8tM3kqsY4TOGmLlvtJw6hyOTuBPG5hmGWPeug17DIfj_ol_WcS9Fpn-Etnb2MEH5tJf7SIHrm2yqwY6K778KVtyKp753W3Q7KU0B8qfqV_AFuHPW2R9T5pjjYCB1NPw_pUO0Gwqxy_0ZEW0EWzKoj21-B1PGOwoA--vkA";

    $publicKey = <<<EOD
-----BEGIN CERTIFICATE-----
MIIC+zCCAeOgAwIBAgIJTk0yAIXCmadQMA0GCSqGSIb3DQEBCwUAMBsxGTAXBgNV
BAMTEHZvbHphcC5hdXRoMC5jb20wHhcNMTcwNjI2MDQyNjA1WhcNMzEwMzA1MDQy
NjA1WjAbMRkwFwYDVQQDExB2b2x6YXAuYXV0aDAuY29tMIIBIjANBgkqhkiG9w0B
AQEFAAOCAQ8AMIIBCgKCAQEA+gFhqCfzIqNy9yifr0tawEW/s/z+C2k5a4jV616l
DwBYZsQfNEeXBauJ5oTlKbP/HkfCsIEJMOT6XI/yO2jdbaaXwWS+Ur+bs+WBjjJE
ewtps/33Sf/P4tAzXQJS1NMlKga8hIVkGTMUgrSUNkJIovibgUAS0/igSNxvyrvr
F4K9Dn21PS18AU+naRtKRsp3xRUmgo/KkN0ThkPuwt7yhi2lCgZhx3H8ICpGhXpx
gdjhwPX1cMPpalHHORCC2Xx6YmUGDaSdJYbZxEivU/9fUa1eA7aSjYXeycP84F0e
GWbuXKAzanI/lPbAECMn6+9CM7UzdKB+IrA+gofXZ5vMMQIDAQABo0IwQDAPBgNV
HRMBAf8EBTADAQH/MB0GA1UdDgQWBBT8wUqAmKhFTaNoJ7wxz7rqGMpTijAOBgNV
HQ8BAf8EBAMCAoQwDQYJKoZIhvcNAQELBQADggEBABYXHtPgqM8TJkBdfRjpv0Az
RtcwjqEfIVkBg6Is93VOwBbNl4YvsNSKKBu73zRmSi26XCj0Ap1lYDgi0AR5PBE7
LCcMIgJagbTu2vQKm7nyM+P7rhwTQPNspepYxrL2wjI7rsWgUdh+5CY1vtTb+ULH
hP1y87Frp61xRNVZFQyDEwok1aXpEXbJmB04FJFEEoq7EDPVbVPxWycq/v6vjwcF
67z3CUT0FdTbWXn0Ppr61R3nKWI6AOsI0UoSuZjlJCQDaeyUSd4/DYy0PCZraW0z
RU0QjJbHux5+wwR2KrjZNCRGeQnfSMbO2/NjzkLjzNhC88dpXU6gE7u/ghDyTo4=
-----END CERTIFICATE-----
EOD;

    $decoded = JWT::decode($jwt, $publicKey, array('RS256'));

    $decoded_array = (array) $decoded;
    echo "Decode:\n" . print_r($decoded_array, true) . "\n";
}
catch (Exception $e) {
    echo $e->getMessage();
}
